export function sanitize(e){if("string"!=typeof e)return e;let t=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");return t=t.replace(/on\w+\s*=\s*["'][^"']*["']/gi,""),t=t.replace(/on\w+\s*=\s*[^\s>]*/gi,""),t=t.replace(/href\s*=\s*["']?javascript:[^"'\s>]*["']?/gi,""),t}export function get(e,t=null){const o=localStorage.getItem(e);if(null===o)return t;try{return JSON.parse(o)}catch{return o}}export function set(e,t){"string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t))}export function remove(e){localStorage.removeItem(e)}export function getAllWithPrefix(e){const t=[];for(let o=0;o<localStorage.length;o++){const r=localStorage.key(o);r.startsWith(e)&&t.push(r)}return t}export function clearPrefix(e){getAllWithPrefix(e).forEach(e=>remove(e))}export function getTheme(){return get("compendium-theme","dark")}export function setTheme(e){set("compendium-theme",e)}export function getProgress(){return get("compendium-progress",{})}export function setProgress(e){set("compendium-progress",e)}export function getAchievements(){return get("compendium-achievements",{})}export function setAchievements(e){set("compendium-achievements",e)}export function getNotes(e){return get(`compendium-notes-${e}`,null)}export function setNotes(e,t){set(`compendium-notes-${e}`,sanitize(t))}export function getCompletedGuides(){const e=getProgress(),t=new Set;for(const[o,r]of Object.entries(e))r&&r.completed&&t.add(o);return t}export function addCompletedGuide(e){const t=getProgress();t[e]||(t[e]={}),t[e].completed=!0,t[e].lastUpdated=(new Date).toISOString(),setProgress(t)}export function getAllNotes(){const e={};return getAllWithPrefix("compendium-notes-").forEach(t=>{const o=t.replace("compendium-notes-","");e[o]=get(t)}),e}