const STORAGE_KEY_LAST_VISIT="app_last_visit_date",STORAGE_KEY_GUIDE_READS="guide_last_read_dates";let previousVisitDate=null;export async function init(){previousVisitDate=localStorage.getItem("app_last_visit_date"),window.addEventListener("cardsRendered",()=>{const t=(new Date).toISOString().split("T")[0];localStorage.setItem("app_last_visit_date",t)},{once:!0})}function getLastVisitDate(){return previousVisitDate||localStorage.getItem("app_last_visit_date")}function getGuideReadDates(){const t=localStorage.getItem("guide_last_read_dates");return t?JSON.parse(t):{}}export function markGuideAsRead(t){const e=(new Date).toISOString().split("T")[0],n=getGuideReadDates();n[t]=e,localStorage.setItem("guide_last_read_dates",JSON.stringify(n))}export function getNewGuides(t){const e=getLastVisitDate();return e?t.filter(t=>(t.lastUpdated||"2026-01-01")>e):[]}export function getUpdatedGuides(t){const e=getGuideReadDates();return t.filter(t=>{const n=t.lastUpdated||"2026-01-01",a=e[t.id];return!!a&&n>a})}export function createWhatsNewSection(t){const e=getNewGuides(t),n=getUpdatedGuides(t),a=e.length+n.length;if(0===a)return null;const s=document.createElement("div");s.className="whats-new-section",s.id="whats-new-section";const i=document.createElement("div");i.className="whats-new-header",i.innerHTML=`\n    <div class="whats-new-title">\n      <span class="whats-new-icon">âœ¨</span>\n      <span>What's New</span>\n      <span class="whats-new-count">${a}</span>\n    </div>\n    <button class="whats-new-toggle" aria-expanded="false" aria-controls="whats-new-content">\n      <span class="toggle-icon">â–¼</span>\n    </button>\n  `,s.appendChild(i);const d=document.createElement("div");if(d.className="whats-new-content",d.id="whats-new-content",e.length>0){const t=document.createElement("div");t.className="whats-new-category",t.innerHTML=`\n      <h3 class="whats-new-category-title">\n        <span class="category-icon">ðŸ†•</span>\n        <span>New Guides (${e.length})</span>\n      </h3>\n      <ul class="whats-new-list">\n        ${e.map(t=>`\n          <li class="whats-new-item">\n            <span class="item-icon">${t.icon||"ðŸ“˜"}</span>\n            <span class="item-title">${t.title}</span>\n            <span class="item-badge">New</span>\n          </li>\n        `).join("")}\n      </ul>\n    `,d.appendChild(t)}if(n.length>0){const t=document.createElement("div");t.className="whats-new-category",t.innerHTML=`\n      <h3 class="whats-new-category-title">\n        <span class="category-icon">ðŸ”„</span>\n        <span>Updated Guides (${n.length})</span>\n      </h3>\n      <ul class="whats-new-list">\n        ${n.map(t=>`\n          <li class="whats-new-item">\n            <span class="item-icon">${t.icon||"ðŸ“˜"}</span>\n            <span class="item-title">${t.title}</span>\n            <span class="item-badge">Updated</span>\n          </li>\n        `).join("")}\n      </ul>\n    `,d.appendChild(t)}s.appendChild(d);const c=i.querySelector(".whats-new-toggle");return c.addEventListener("click",()=>{const t="true"===c.getAttribute("aria-expanded");c.setAttribute("aria-expanded",!t),d.classList.toggle("expanded")}),s}export function addBadgesToCard(t,e,n=[]){const a=getGuideReadDates()[e.id];if(a){const n=e.lastUpdated||"2026-01-01";if(n>a){const e=document.createElement("span");e.className="notification-badge badge-updated",e.textContent="Updated",e.title=`Updated on ${n}`,t.appendChild(e)}}const s=getLastVisitDate();if(s){const n=e.lastUpdated||"2026-01-01";if(n>s){const e=document.createElement("span");e.className="notification-badge badge-new",e.textContent="New",e.title=`Added on ${n}`,t.appendChild(e)}}}